<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Verbum Indexer Control</title>
    <link rel="stylesheet" href="styles.css"/>
</head>
<body>
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <div class="container">
        <div class="header">
            <div class="title-section">
                <h1>Verbum File Search Engine</h1>
                <p class="subtitle">Index your files and search through their content instantly</p>
            </div>
            <button 
                type="button" 
                class="help-button" 
                onclick="openShortcutsDialog()" 
                aria-label="Show keyboard shortcuts"
                title="Show keyboard shortcuts (Press ? for shortcuts)"
            >
                Help
            </button>
        </div>
        
        <main class="content" id="main-content">
            <section class="card" aria-labelledby="query-heading">
                <div class="section-header">
                    <h2 id="query-heading">üîç Search Your Files <div class="tooltip" data-tooltip="Search for any word across all your indexed files. Files must be added to indexing first.">?</div></h2>
                </div>
                <p class="section-description">Find files containing specific words from all your indexed content</p>
                <form class="row" role="search" aria-label="Search the index" onsubmit="event.preventDefault(); queryIndexer();">
                    <label for="queryWord" class="sr-only">Search term</label>
                    <input 
                        type="text" 
                        id="queryWord" 
                        placeholder="Type any word to search (e.g., 'function', 'TODO', 'import')"
                        aria-describedby="query-help"
                        autocomplete="off"
                        tabindex="1"
                    />
                    <button 
                        type="submit" 
                        aria-describedby="search-shortcut"
                        tabindex="2"
                    >Search Files</button>
                    <span id="query-help" class="sr-only">Press Enter to search or Escape to clear</span>
                    <span id="search-shortcut" class="sr-only">Keyboard shortcut: Enter</span>
                </form>
                <div 
                    id="results" 
                    role="region" 
                    aria-label="Search results" 
                    aria-live="polite"
                    tabindex="0"
                ></div>
            </section>

            <section class="card" aria-labelledby="paths-heading">
                <div class="section-header">
                    <h2 id="paths-heading">üìÅ Add Files & Folders to Index <div class="tooltip" data-tooltip="Add files or folders to make their content searchable. The indexer will scan all text files and create a searchable index.">?</div></h2>
                </div>
                <p class="section-description">Choose files or folders to make their content searchable</p>
                <form class="row" aria-label="Add or remove indexing paths">
                    <div class="input-group">
                        <label for="pathInput" class="sr-only">File or directory path to index</label>
                        <div class="input-wrapper">
                            <input 
                                type="text" 
                                id="pathInput" 
                                placeholder="Enter path to file or folder to index (e.g., /Users/john/Documents)"
                                aria-describedby="path-help path-validation"
                                autocomplete="off"
                                tabindex="3"
                                list="pathSuggestions"
                            />
                            <button 
                                type="button" 
                                class="browse-button" 
                                onclick="openFilePicker()" 
                                aria-label="Browse for file or directory to index"
                                tabindex="3.5"
                                title="Browse for file or directory to index"
                            >
                                üìÅ
                            </button>
                            <datalist id="pathSuggestions"></datalist>
                        </div>
                        <div id="path-validation" class="validation-message" aria-live="polite"></div>
                    </div>
                    <div class="button-group">
                        <button 
                            type="button" 
                            id="addPathBtn"
                            onclick="addPath()" 
                            aria-describedby="add-path-desc"
                            tabindex="4"
                            disabled
                        >Add to Index</button>
                    </div>
                    <span id="path-help" class="sr-only">Enter a file or directory path to add to or remove from the search index</span>
                    <span id="add-path-desc" class="sr-only">Add the specified path to the search index</span>
                    <span id="remove-path-desc" class="sr-only">Remove the specified path from the search index</span>
                </form>
                
                <div class="path-list" id="pathList" aria-labelledby="paths-list-heading">
                    <div class="section-header">
                        <h3 id="paths-list-heading" class="path-list-title">üìã Currently Indexed <div class="tooltip-small" data-tooltip="These files and folders are being monitored and their content is searchable. Changes to these files are automatically indexed.">?</div></h3>
                    </div>
                    <div id="pathsContainer" class="paths-container" role="list" aria-live="polite">
                        <div class="empty-state">No files or folders indexed yet. Add some above to start searching!</div>
                    </div>
                </div>
            </section>

            <section class="card" aria-labelledby="control-heading">
                <div class="section-header">
                    <h2 id="control-heading">‚öôÔ∏è Settings & Monitoring <div class="tooltip" data-tooltip="Control how the search engine behaves and monitor its activity.">?</div></h2>
                </div>
                <p class="section-description">Configure automatic features and monitor system activity</p>
                <div class="controls-row" role="group" aria-labelledby="control-heading">
                    <div class="control-group">
                        <div class="control-header">
                            <label class="control-label" for="autoQuerySwitch">üîÑ Auto-Refresh Search <div class="tooltip-small" data-tooltip="When enabled, your search results will automatically update every 2 seconds to show the latest matches.">?</div></label>
                        </div>
                        <label class="switch" aria-describedby="auto-query-desc">
                            <input 
                                id="autoQuerySwitch" 
                                type="checkbox" 
                                role="switch"
                                aria-describedby="auto-query-desc"
                                tabindex="6"
                            >
                            <span class="slider" aria-hidden="true"></span>
                        </label>
                        <span id="auto-query-desc" class="sr-only">Automatically refresh search results every 2 seconds</span>
                    </div>
                    <div class="control-group">
                        <div class="control-header">
                            <label class="control-label" for="indexerSwitch">üèÉ Live File Monitoring <div class="tooltip-small" data-tooltip="When enabled, the system automatically detects changes to your files and updates the search index in real-time.">?</div></label>
                        </div>
                        <label class="switch" aria-describedby="indexer-desc">
                            <input 
                                id="indexerSwitch" 
                                type="checkbox" 
                                role="switch"
                                aria-describedby="indexer-desc"
                                tabindex="7"
                            >
                            <span class="slider" aria-hidden="true"></span>
                        </label>
                        <span id="indexer-desc" class="sr-only">Enable or disable real-time file monitoring and indexing</span>
                    </div>
                </div>

                <div class="status-log" role="region" aria-labelledby="log-heading">
                    <div class="section-header">
                        <label id="log-heading" for="statusLog">üìù Activity Log <div class="tooltip-small" data-tooltip="Real-time log showing what the search engine is doing - indexing files, processing searches, detecting changes, etc.">?</div></label>
                    </div>
                    <textarea 
                        id="statusLog" 
                        readonly 
                        placeholder="System activity will be logged here - file indexing, searches, changes, etc..."
                        aria-describedby="log-help"
                        aria-live="polite"
                        tabindex="8"
                    ></textarea>
                    <span id="log-help" class="sr-only">Live log showing search engine activity and operations</span>
                </div>
            </section>
        </main>
    </div>

    <!-- Keyboard Shortcuts Dialog -->
    <div 
        id="shortcutsDialog" 
        class="dialog-overlay" 
        role="dialog" 
        aria-labelledby="shortcuts-title"
        aria-describedby="shortcuts-description" 
        aria-modal="true"
        hidden
    >
        <div class="dialog-content">
            <div class="dialog-header">
                <h2 id="shortcuts-title">Keyboard Shortcuts</h2>
                <button 
                    type="button" 
                    class="dialog-close" 
                    onclick="closeShortcutsDialog()"
                    aria-label="Close shortcuts dialog"
                >
                    √ó
                </button>
            </div>
            <div id="shortcuts-description" class="dialog-body">
                <div class="shortcuts-grid">
                    <div class="shortcut-group">
                        <h3>Search</h3>
                        <div class="shortcut-item">
                            <kbd>Enter</kbd>
                            <span>Search index</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Escape</kbd>
                            <span>Clear search</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Ctrl</kbd> + <kbd>K</kbd>
                            <span>Focus search</span>
                        </div>
                    </div>
                    
                    <div class="shortcut-group">
                        <h3>Path Management</h3>
                        <div class="shortcut-item">
                            <kbd>Enter</kbd>
                            <span>Add path</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Shift</kbd> + <kbd>Enter</kbd>
                            <span>Remove path</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Alt</kbd> + <kbd>P</kbd>
                            <span>Focus path input</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Escape</kbd>
                            <span>Clear path input</span>
                        </div>
                    </div>
                    
                    <div class="shortcut-group">
                        <h3>Navigation</h3>
                        <div class="shortcut-item">
                            <kbd>Alt</kbd> + <kbd>L</kbd>
                            <span>Focus status log</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Tab</kbd>
                            <span>Next element</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Shift</kbd> + <kbd>Tab</kbd>
                            <span>Previous element</span>
                        </div>
                    </div>
                    
                    <div class="shortcut-group">
                        <h3>Help</h3>
                        <div class="shortcut-item">
                            <kbd>?</kbd>
                            <span>Show this dialog</span>
                        </div>
                        <div class="shortcut-item">
                            <kbd>Escape</kbd>
                            <span>Close dialog</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
